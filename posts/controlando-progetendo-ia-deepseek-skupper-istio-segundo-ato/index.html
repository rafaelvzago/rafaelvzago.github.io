<!doctype html><html lang="pt-BR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato" /><meta property="og:locale" content="pt_BR" /><meta name="description" content="Neste artigo, vamos implementar passo a passo o chatbot com o Instructlab, além de expor o serviço de forma segura usando Skupper" /><meta property="og:description" content="Neste artigo, vamos implementar passo a passo o chatbot com o Instructlab, além de expor o serviço de forma segura usando Skupper" /><link rel="canonical" href="https://rafaelvzago.github.io/posts/controlando-progetendo-ia-deepseek-skupper-istio-segundo-ato/" /><meta property="og:url" content="https://rafaelvzago.github.io/posts/controlando-progetendo-ia-deepseek-skupper-istio-segundo-ato/" /><meta property="og:site_name" content="Rafael Zago" /><meta property="og:image" content="https://rafaelvzago.github.io/assets/img/headers/controlando-e-protegendo-modelos-de-ia-pt2.png" /><meta property="og:image:alt" content="Instructlab with Skupper" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-05-04T00:00:00-03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://rafaelvzago.github.io/assets/img/headers/controlando-e-protegendo-modelos-de-ia-pt2.png" /><meta name="twitter:image:alt" content="Instructlab with Skupper" /><meta property="twitter:title" content="Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato" /><meta name="twitter:site" content="@rafaelvzago" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-04T00:00:00-03:00","datePublished":"2025-05-04T00:00:00-03:00","description":"Neste artigo, vamos implementar passo a passo o chatbot com o Instructlab, além de expor o serviço de forma segura usando Skupper","headline":"Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato","image":{"alt":"Instructlab with Skupper","url":"https://rafaelvzago.github.io/assets/img/headers/controlando-e-protegendo-modelos-de-ia-pt2.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rafaelvzago.github.io/posts/controlando-progetendo-ia-deepseek-skupper-istio-segundo-ato/"},"url":"https://rafaelvzago.github.io/posts/controlando-progetendo-ia-deepseek-skupper-istio-segundo-ato/"}</script><title>Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato | Rafael Zago</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/pt.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-9J3YRPN8EN"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-9J3YRPN8EN'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://gravatar.com/userimage/75121319/3dc8bb7e7befedea878842edafcb1335.jpeg?size=256" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Rafael Zago</a><p class="site-subtitle fst-italic mb-0">Meu bloco de notas na interwebs..</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARQUIVOS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>SOBRE</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/rafaevzago" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rafaelvzago" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancelar</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato</h1><p class="post-desc fw-light mb-4">Neste artigo, vamos implementar passo a passo o chatbot com o Instructlab, além de expor o serviço de forma segura usando Skupper</p><div class="post-meta text-muted"> <span> Postado em <time data-ts="1746327600" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 04/05/2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/img/headers/controlando-e-protegendo-modelos-de-ia-pt2.png" class="popup img-link preview-img shimmer"><img src="/assets/img/headers/controlando-e-protegendo-modelos-de-ia-pt2.png" alt="Instructlab with Skupper" width="1200" height="630" loading="lazy"></a><figcaption class="text-center pt-2 pb-2">Instructlab with Skupper</figcaption></div><div class="d-flex justify-content-between"> <span> Por <em> <a href="https://github.com/rafaelvzago">Rafael Zago</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3483 palavras" > <em>19 min</em> de leitura</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Conteúdo</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="veja-a-solução-em-ação"><span class="me-2">Veja a Solução em Ação</span><a href="#veja-a-solução-em-ação" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Neste artigo, vamos preparar todo o ambiente para servir o modelo de IA generativo Deepseek usando o InstructLab, baixando o modelo, convertendo-o para o formato GGUF e implantando o chatbot InstructLab. Além disso, vamos expor o serviço de forma segura usando Skupper.</p><h3 id="conceitos-e-comandos-usados-na-demonstração"><span class="me-2">Conceitos e Comandos Usados na Demonstração</span><a href="#conceitos-e-comandos-usados-na-demonstração" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>NOTA Certifique-se de explicar o que cada comando Skupper faz na primeira vez que você o usa, especialmente para pessoas não familiarizadas com o Skupper. Os seguintes comandos devem ser explicados:</p><p><strong><code class="language-plaintext highlighter-rouge">skupper init</code></strong>: Inicializa a rede Skupper, configurando os componentes necessários para habilitar a comunicação segura entre os serviços.</p><p><strong><code class="language-plaintext highlighter-rouge">skupper expose</code></strong>: Expõe um serviço local através da rede Skupper, permitindo que ele seja acessado a partir de outros sites conectados ao Skupper.</p><p><strong><code class="language-plaintext highlighter-rouge">skupper token</code></strong>: Gera um token de conexão que pode ser usado por outros sites para se conectar à rede Skupper, garantindo uma comunicação segura.</p><p><strong><code class="language-plaintext highlighter-rouge">skupper link</code></strong>: Estabelece um link seguro entre dois sites Skupper usando o token criado por <code class="language-plaintext highlighter-rouge">skupper token</code>.</p><p><strong><code class="language-plaintext highlighter-rouge">skupper service status</code></strong>: Exibe o status dos serviços expostos através do Skupper, mostrando o que está acessível e como está conectado dentro da rede.</p><p><strong><code class="language-plaintext highlighter-rouge">ilab download</code></strong>: Baixa o modelo a ser usado pelo chatbot.</p><p><strong><code class="language-plaintext highlighter-rouge">ilab model serve</code></strong>: Inicia o servidor que será responsável por receber a entrada do usuário, enviá-la para o modelo LLaMA3 e enviar a resposta de volta ao usuário.</p><p><strong><code class="language-plaintext highlighter-rouge">ilab model chat</code></strong>: Inicia o chatbot, permitindo que o usuário interaja com ele.</p></blockquote><h3 id="executar-a-demonstração"><span class="me-2">Executar a demonstração</span><a href="#executar-a-demonstração" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="antes-de-começar"><span class="me-2">Antes de começar</span><a href="#antes-de-começar" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Para configurar a demonstração, você precisa ter os seguintes pré-requisitos:</p><ul><li><p>Acesso a um cluster Kubernetes com o Skupper e o InstructLab instalados.</p><li><p>Um servidor executando o modelo de chat do InstructLab.</p><li><p>Acesso a um terminal para executar os comandos.</p><li><p>Acesso a um navegador da web para interagir com o chatbot.</p><li><p>Cliente skupper instalado e configurado para acessar o cluster Kubernetes.</p><li><p>Podman instalado para executar o Skupper privado.</p></ul><h4 id="implantação-do-modelo-de-ia-com-o-instructlab"><span class="me-2">Implantação do Modelo de IA com o InstructLab</span><a href="#implantação-do-modelo-de-ia-com-o-instructlab" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>O primeiro passo é implantar o modelo de chat do InstructLab no site do InstructLab. O modelo de chat do InstructLab será responsável por receber a entrada do usuário e enviá-la para o modelo LLaMA3. A resposta do modelo LLaMA3 será enviada de volta ao usuário. Isso é baseado no artigo: <a href="https://developers.redhat.com/blog/2024/06/12/getting-started-instructlab-generative-ai-model-tuning#model_alignment_and_training_with_instructlab">https://developers.redhat.com/blog/2024/06/12/getting-started-instructlab-generative-ai-model-tuning#model_alignment_and_training_with_instructlab</a> [Primeiros passos com o InstructLab para ajuste de modelo de IA generativo].</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>instructlab <span class="o">&amp;&amp;</span> <span class="nb">cd </span>instructlab
<span class="nb">sudo </span>dnf <span class="nb">install </span>gcc gcc-c++ make git python3.11 python3.11-devel
python3.11 <span class="nt">-m</span> venv <span class="nt">--upgrade-deps</span> venv
<span class="nb">source </span>venv/bin/activate
pip <span class="nb">install </span>instructlab
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">mkdir instructlab &amp;&amp; cd instructlab</code> é usado para criar um diretório chamado <code class="language-plaintext highlighter-rouge">instructlab</code> e navegar até ele.</p><p>O comando <code class="language-plaintext highlighter-rouge">sudo dnf install gcc gcc-c++ make git python3.11 python3.11-devel</code> é usado para instalar as dependências necessárias para o InstructLab.</p><p>O comando <code class="language-plaintext highlighter-rouge">python3.11 -m venv --upgrade-deps venv</code> é usado para criar um ambiente virtual chamado <code class="language-plaintext highlighter-rouge">venv</code> para o InstructLab.</p><p>O comando <code class="language-plaintext highlighter-rouge">source venv/bin/activate</code> é usado para ativar o ambiente virtual.</p><p>O comando <code class="language-plaintext highlighter-rouge">pip install instructlab</code> é usado para instalar o InstructLab no ambiente virtual.</p></blockquote><h4 id="inicializar-a-configuração-do-instructlab"><span class="me-2">Inicializar a Configuração do InstructLab</span><a href="#inicializar-a-configuração-do-instructlab" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Agora é hora de inicializar a configuração do InstructLab. O comando <code class="language-plaintext highlighter-rouge">ilab config init</code> é usado para inicializar a configuração do InstructLab, criando o arquivo <code class="language-plaintext highlighter-rouge">config.yaml</code> com a configuração padrão. Execute o seguinte comando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ilab config init
</pre></table></code></div></div><p>A saída será semelhante à seguinte, com o usuário sendo solicitado a fornecer os valores necessários para inicializar o ambiente:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>Welcome to InstructLab CLI.
This guide will <span class="nb">help </span>you to setup your environment.
Please provide the following values to initiate the environment <span class="o">[</span>press Enter <span class="k">for </span>defaults]:
Path to taxonomy repo <span class="o">[</span>/home/user/.local/share/instructlab/taxonomy]:
Path to your model <span class="o">[</span>/home/user/.cache/instructlab/models/merlinite-7b-lab-Q4_K_M.gguf]:
Generating <span class="sb">`</span>/home/user/.config/instructlab/config.yaml<span class="sb">`</span> and <span class="sb">`</span>/home/user/.local/share/instructlab/internal/train_configuration/profiles<span class="sb">`</span>...
Please choose a train profile to use.
Train profiles assist with the complexity of configuring specific GPU hardware with the InstructLab Training library.
You can still take advantage of hardware acceleration <span class="k">for </span>training even <span class="k">if </span>your hardware is not listed.
<span class="o">[</span>0] No profile <span class="o">(</span>CPU, Apple Metal, AMD ROCm<span class="o">)</span>
<span class="o">[</span>1] Nvidia A100<span class="se">\/</span>H100 x2 <span class="o">(</span>A100_H100_x2.yaml<span class="o">)</span>
<span class="o">[</span>2] Nvidia A100<span class="se">\/</span>H100 x4 <span class="o">(</span>A100_H100_x4.yaml<span class="o">)</span>
<span class="o">[</span>3] Nvidia A100<span class="se">\/</span>H100 x8 <span class="o">(</span>A100_H100_x8.yaml<span class="o">)</span>
<span class="o">[</span>4] Nvidia L40 x4 <span class="o">(</span>L40_x4.yaml<span class="o">)</span>
<span class="o">[</span>5] Nvidia L40 x8 <span class="o">(</span>L40_x8.yaml<span class="o">)</span>
<span class="o">[</span>6] Nvidia L4 x8 <span class="o">(</span>L4_x8.yaml<span class="o">)</span>
Enter the number of your choice <span class="o">[</span>hit enter <span class="k">for </span>no profile] <span class="o">[</span>0]:
No profile selected - any hardware acceleration <span class="k">for </span>training must be configured manually.
Initialization completed successfully, you<span class="s1">'re ready to start using `ilab`.
Enjoy!
</span></pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">ilab config init</code> é usado para inicializar a configuração do InstructLab, criando o arquivo <code class="language-plaintext highlighter-rouge">config.yaml</code> com a configuração padrão.</p><p>O usuário é solicitado a fornecer os valores necessários para inicializar o ambiente, como o caminho para o repositório de taxonomia e o caminho para o modelo.</p><p>Após executar o <code class="language-plaintext highlighter-rouge">ilab config init</code>, seus diretórios serão semelhantes aos seguintes em um sistema Linux:</p></blockquote><h5 id="arquivos-e-diretórios-criados"><span class="me-2">Arquivos e diretórios criados</span><a href="#arquivos-e-diretórios-criados" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> ~/.cache/instructlab/models/           <span class="c"># Diretório onde os modelos são armazenados. </span>
 ~/.local/share/instructlab/datasets    <span class="c"># Diretório onde os conjuntos de dados são armazenados. </span>
 ~/.local/share/instructlab/taxonomy    <span class="c"># Diretório onde a taxonomia é armazenada.</span>
 ~/.local/share/instructlab/checkpoints <span class="c"># Diretório onde os checkpoints são armazenados. </span>
</pre></table></code></div></div><p>Para habilitar o acesso externo ao seu modelo, modifique o arquivo <code class="language-plaintext highlighter-rouge">config.yaml</code>, localizado no seu diretório <code class="language-plaintext highlighter-rouge">instructlab</code>: ~/.config/instructlab/config.yaml. Essa alteração precisa ser feita na seção <code class="language-plaintext highlighter-rouge">serve</code>, conforme mostrado abaixo:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="na">host_port</span><span class="pi">:</span> <span class="s">0.0.0.0:8000</span>
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O <code class="language-plaintext highlighter-rouge">host_port:</code> O endereço IP e a porta onde o modelo será exposto.</p><p>Neste caso, o modelo será exposto em todas as interfaces.</p></blockquote><h3 id="baixando-e-convertendo-o-modelo-deepseek-para-o-instructlab"><span class="me-2">Baixando e Convertendo o modelo DEEPSEEK para o InstructLab</span><a href="#baixando-e-convertendo-o-modelo-deepseek-para-o-instructlab" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Agora, você precisa baixar o modelo que será usado pelo chatbot e convertê-lo para o formato GGUF. O InstructLab suporta vários modelos, mas para esta demonstração, usaremos o modelo DEEPSEEK. O comando <code class="language-plaintext highlighter-rouge">ilab model download</code> é usado para baixar o modelo a ser usado pelo chatbot.</p><h4 id="criando-um-token-do-hugginface"><span class="me-2">Criando um token do hugginface</span><a href="#criando-um-token-do-hugginface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Para baixar o modelo, você precisa de um token do Hugging Face. Se você não tiver um token, crie uma conta no Hugging Face e gere um token de acesso. Depois de obter o token, execute o seguinte comando para configurá-lo:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">HF_TOKEN</span><span class="o">=</span>&lt;seu_token&gt;
</pre></table></code></div></div><blockquote><p>NOTA O comando <code class="language-plaintext highlighter-rouge">export HF_TOKEN=&lt;seu_token&gt;</code> é usado para definir a variável de ambiente <code class="language-plaintext highlighter-rouge">HF_TOKEN</code> com o seu token do Hugging Face. Isso é necessário para baixar o modelo do Hugging Face.</p></blockquote><h4 id="baixando-o-modelo-deepseek"><span class="me-2">Baixando o modelo DEEPSEEK</span><a href="#baixando-o-modelo-deepseek" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Antes de iniciar o servidor, baixe o modelo a ser usado pelo chatbot. O comando <code class="language-plaintext highlighter-rouge">ilab download</code> é usado para baixar o modelo a ser usado pelo chatbot. Execute o seguinte comando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ilab model download <span class="nt">--repository</span> deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">ilab download</code> é usado para baixar o modelo a ser usado pelo chatbot.</p></blockquote><h4 id="convertendo-o-modelo-para-formato-gguf"><span class="me-2">Convertendo o modelo para formato GGUF</span><a href="#convertendo-o-modelo-para-formato-gguf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Após baixar o modelo, você precisa convertê-lo para o formato GGUF usando o llama.cpp. Primeiro, clone o repositório llama.cpp:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>git clone https://github.com/ggerganov/llama.cpp
<span class="nb">cd </span>llama.cpp
</pre></table></code></div></div><p>Siga as instruções de instalação do llama.cpp conforme descrito no repositório. Após a instalação, execute o comando de conversão:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python ./convert_hf_to_gguf.py /home/rzago/.cache/instructlab/models/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B <span class="nt">--outfile</span> deepseek_f16.gguf <span class="nt">--outtype</span> f16
</pre></table></code></div></div><p>Agora mova o arquivo convertido para o diretório de modelos do InstructLab:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">mv </span>deepseek_f16.gguf <span class="nv">$HOME</span>/.cache/instructlab/models/DeepSeek-R1-Distill-Qwen-1.5B.gguf
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">git clone https://github.com/ggerganov/llama.cpp</code> é usado para baixar o repositório llama.cpp.</p><p>O comando <code class="language-plaintext highlighter-rouge">python ./convert_hf_to_gguf.py</code> é usado para converter o modelo baixado do formato Hugging Face para o formato GGUF.</p><p>O parâmetro <code class="language-plaintext highlighter-rouge">--outtype f16</code> especifica que a conversão será feita em formato float16 para otimizar o tamanho do arquivo.</p><p>O comando <code class="language-plaintext highlighter-rouge">mv</code> move o arquivo convertido para o diretório padrão onde o InstructLab procura por modelos.</p><p>Agora, inicie o servidor que será responsável por receber a entrada do usuário, enviá-la para o modelo e enviar a resposta de volta ao usuário. O comando <code class="language-plaintext highlighter-rouge">ilab model serve</code> é usado para iniciar o servidor. Execute o seguinte comando:</p></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ilab model serve <span class="nt">--model-path</span> ~/.cache/instructlab/models/DeepSeek-R1-Distill-Qwen-1.5B.gguf
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">ilab model serve --model-path</code> é usado para iniciar o servidor especificando o caminho do modelo convertido que será responsável por receber a entrada do usuário, enviá-la para o modelo e enviar a resposta de volta ao usuário.</p></blockquote><h3 id="implantação-do-skupper-público"><span class="me-2">Implantação do Skupper Público</span><a href="#implantação-do-skupper-público" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Para expor o serviço do InstructLab para a internet, você precisa implantar o Skupper público no Ambiente Local Público. O Skupper público será responsável por expor o serviço do InstructLab para a internet, permitindo que o aplicativo Ollama Pilot envie solicitações ao modelo de chat do InstructLab.</p><p>Nessa demonstração, estamos utilizando o Kubernetes como plataforma para implantar o Skupper público. O Skupper público será responsável por expor o serviço do InstructLab para a internet, permitindo que o aplicativo Ollama Pilot envie solicitações ao modelo de chat do InstructLab. Para instalar o skupper, vamos usar o <code class="language-plaintext highlighter-rouge">skupper</code> cli, que é uma ferramenta de linha de comando para interagir com o Skupper.</p><h4 id="instalar-o-skupper-público"><span class="me-2">Instalar o Skupper Público</span><a href="#instalar-o-skupper-público" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Para instalar o Skupper público, vamos usar o <code class="language-plaintext highlighter-rouge">skupper</code> cli, que é uma ferramenta de linha de comando para interagir com o Skupper. O Skupper CLI é usado para criar e gerenciar sites Skupper, além de expor serviços e estabelecer links entre sites.</p><ol><li><p><strong>Instalar o Skupper CLI</strong></p><p>Execute o seguinte comando para instalar o Skupper CLI:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl https://skupper.io/v2/install.sh | sh
</pre></table></code></div></div></ol><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">curl https://skupper.io/v2/install.sh | sh</code> é usado para baixar e instalar o Skupper CLI no seu ambiente local. Isso é necessário para interagir com o Skupper e implantar o serviço do InstructLab.</p></blockquote><ol><li><p><strong>Instalar o Skupper no cluster Kubernetes</strong></p><p>Após instalar o Skupper CLI, você precisa instalar o Skupper no cluster Kubernetes. Execute o seguinte comando para instalar o Skupper no cluster Kubernetes:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>kubectl create ns skupper
kubectl apply <span class="nt">-f</span> https://skupper.io/v2/install.yaml <span class="nt">-n</span> skupper
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">kubectl create ns skupper</code> cria um namespace chamado <code class="language-plaintext highlighter-rouge">skupper</code> no cluster Kubernetes. Isso é necessário para isolar os recursos do Skupper e do InstructLab em um namespace separado. O comando <code class="language-plaintext highlighter-rouge">kubectl apply -f https://skupper.io/v2/install.yaml -n skupper</code> aplica o manifesto de instalação do Skupper no cluster Kubernetes, criando os recursos necessários para o Skupper funcionar. Isso inclui o pod <code class="language-plaintext highlighter-rouge">skupper-router</code>, que é responsável pelo roteamento de tráfego entre sites.</p></blockquote><li><p><strong>Criar o namespace e inicializar o Skupper no cluster Kubernetes</strong></p><p>Após instalar o Skupper CLI, você precisa criar um namespace no cluster Kubernetes onde o Skupper será implantado. Execute o seguinte comando para criar um namespace chamado <code class="language-plaintext highlighter-rouge">ilab-chat</code> e inicializar o Skupper:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
 kubectl create ns ilab-chat
 <span class="nb">export </span><span class="nv">SKUPPER_PLATFORM</span><span class="o">=</span>kubernetes
 skupper site create ilab-chat <span class="nt">-n</span> ilab-chat <span class="nt">--enable-link-access</span>
</pre></table></code></div></div><blockquote><p>NOTA O comando <code class="language-plaintext highlighter-rouge">kubectl create ns ilab-chat</code> cria um novo namespace chamado <code class="language-plaintext highlighter-rouge">ilab-chat</code> no cluster Kubernetes. Isso é necessário para isolar os recursos do Skupper e do InstructLab em um namespace separado. O comando <code class="language-plaintext highlighter-rouge">export SKUPPER_PLATFORM=kubernetes</code> define a plataforma como Kubernetes, que é necessária para o Skupper funcionar corretamente. O comando <code class="language-plaintext highlighter-rouge">skupper site create ilab-chat -n ilab-chat --enable-link-access</code> inicializa o Skupper no namespace <code class="language-plaintext highlighter-rouge">ilab-chat</code>, criando os recursos necessários para a comunicação segura entre os serviços. A opção <code class="language-plaintext highlighter-rouge">--enable-link-access</code> permite que outros sites Skupper se conectem a este site, facilitando a comunicação entre diferentes ambientes.</p></blockquote><li><p><strong>Verificar a instalação do Skupper</strong></p><p>Após a criação do namespace, você pode verificar se o Skupper foi instalado corretamente executando o seguinte comando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> kubectl get pods <span class="nt">-n</span> ilab-chat
</pre></table></code></div></div><p>A saída deve mostrar que o pod skupper-router está em execução, o que indica que o Skupper foi instalado com sucesso.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> NAME                            READY   STATUS    RESTARTS   AGE
 skupper-router-cfc4c58f-pmhqv   2/2     Running   0          47s
</pre></table></code></div></div></ol><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">kubectl get pods -n ilab-chat</code> é usado para verificar o status dos pods no namespace <code class="language-plaintext highlighter-rouge">ilab-chat</code>. A saída deve mostrar que o pod <code class="language-plaintext highlighter-rouge">skupper-router</code> está em execução, o que indica que o Skupper foi instalado com sucesso. O pod skupper-router é o componente principal do Skupper, responsável pelo roteamento de tráfego entre sites.</p></blockquote><h3 id="implantação-do-skupper-privado"><span class="me-2">Implantação do Skupper Privado</span><a href="#implantação-do-skupper-privado" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>O segundo passo é implantar o Skupper privado no Ambiente Local Privado. O Skupper privado será responsável por criar uma conexão segura entre os dois sites, permitindo que o aplicativo Ollama Pilot envie solicitações ao modelo de chat do InstructLab.</p><h4 id="instalar-o-skupper"><span class="me-2">Instalar o Skupper</span><a href="#instalar-o-skupper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Para instalar o skupper no site A, com o podman como plataforma, abra um novo terminal para lidar com todos os comandos relacionados ao Skupper privado. Aqui, criaremos um site Skupper usando o podman como plataforma, precisamos habilitar o serviço podman antes de executar o comando skupper init:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>systemctl <span class="nt">--user</span> <span class="nb">enable</span> <span class="nt">--now</span> podman.socket
</pre></table></code></div></div><blockquote><p>NOTA</p><p><code class="language-plaintext highlighter-rouge">systemctl --user enable --now podman.socket</code> é usado para habilitar e iniciar o serviço podman no nível do usuário.</p></blockquote><p>Agora, execute os seguintes comandos para instalar o Skupper:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">SKUPPER_PLATFORM</span><span class="o">=</span>podman
skupper site create ilab-podman
skupper connector create instructlab 8000 <span class="nt">--host</span> localhost
</pre></table></code></div></div><blockquote><p>NOTA</p><p><code class="language-plaintext highlighter-rouge">SKUPPER_PLATFORM=podman</code> é usado para definir a plataforma como podman. Isso é necessário porque o Skupper privado será executado em um contêiner podman.</p><p><code class="language-plaintext highlighter-rouge">skupper site create ilab-podman</code> é usado para criar um site Skupper chamado <code class="language-plaintext highlighter-rouge">ilab-podman</code>, configurando os componentes necessários para habilitar a comunicação segura entre os serviços.</p><p><code class="language-plaintext highlighter-rouge">skupper connector create instructlab 8000 --host localhost</code> é usado para criar um conector que conecta o serviço InstructLab local (executando na porta 8000) à rede Skupper, tornando-o disponível para sites remotos.</p></blockquote><h3 id="comunicação-segura-entre-os-dois-sites-com-skupper"><span class="me-2">Comunicação Segura Entre os Dois Sites com Skupper</span><a href="#comunicação-segura-entre-os-dois-sites-com-skupper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Agora é hora de estabelecer uma conexão segura entre os dois sites. Primeiro, no site público (Kubernetes), gere o link para conexão:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>skupper <span class="nb">link </span>generate <span class="nt">-n</span> ilab-chat <span class="o">&gt;</span> /tmp/link.yaml
</pre></table></code></div></div><blockquote><p>NOTA</p><p><code class="language-plaintext highlighter-rouge">skupper link generate</code> é usado para gerar um arquivo de configuração de link que contém as credenciais necessárias para estabelecer uma conexão segura entre sites Skupper.</p></blockquote><p>Agora, no site privado (podman), prepare o diretório de recursos e mova o arquivo de link:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$HOME</span>/.local/share/skupper/namespaces/default/input/resources
<span class="nb">mv</span> /tmp/link.yaml <span class="nv">$HOME</span>/.local/share/skupper/namespaces/default/input/resources/link.yaml
skupper system setup <span class="nt">--force</span>
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">mkdir -p</code> cria a estrutura de diretórios necessária para o Skupper gerenciar recursos de entrada.</p><p>O arquivo <code class="language-plaintext highlighter-rouge">link.yaml</code> é movido para o diretório de recursos onde o Skupper pode detectá-lo automaticamente.</p><p><code class="language-plaintext highlighter-rouge">skupper system setup --force</code> força a reconfiguração do sistema Skupper para aplicar o novo link.</p></blockquote><p>Verifique o status do link Skupper:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>skupper <span class="nb">link </span>status link-ilab-chat

Name:           link-ilab-chat
Status:         Ok
Cost:           1
TlsCredentials: link-ilab-chat
Endpoint:       skupper-router-inter-router-ilab-chat.apps.<span class="k">*********</span>.com:443
</pre></table></code></div></div><blockquote><p>NOTA</p><p><code class="language-plaintext highlighter-rouge">skupper link status</code> é usado para exibir o status de um link específico na rede Skupper.</p><p>O status “Ok” indica que a conexão foi estabelecida com sucesso.</p><p>O endpoint mostra a URL pública onde o link está ativo (mascarado por segurança).</p></blockquote><blockquote><p>NOTA</p><p>O parâmetro <code class="language-plaintext highlighter-rouge">instructlab</code> é o nome do serviço que será exposto, e <code class="language-plaintext highlighter-rouge">8000</code> é a porta onde o serviço está sendo executado. O parâmetro <code class="language-plaintext highlighter-rouge">--host localhost</code> especifica que o conector deve se conectar ao serviço local na interface de loopback (localhost), permitindo que o serviço seja acessado dentro do ambiente privado.</p></blockquote><h4 id="criando-o-listener-no-site-público"><span class="me-2">Criando o Listener no Site Público</span><a href="#criando-o-listener-no-site-público" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>A última etapa é criar um listener no site público para receber as conexões do connector no site privado. Esta é a configuração que permite que o aplicativo no cluster público acesse o modelo de IA no ambiente privado.</p><ul><li>Ainda no terminal onde o Skupper <strong>público</strong> está em execução, execute o seguinte comando para criar o listener, já que é neste site o serviço será consumido:</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>skupper listener create instructlab 8000 <span class="nt">-n</span> ilab-chat
</pre></table></code></div></div><blockquote><p>NOTA</p><p>O comando <code class="language-plaintext highlighter-rouge">skupper listener create instructlab 8000</code> cria um listener que expõe o serviço <code class="language-plaintext highlighter-rouge">instructlab</code> na porta <code class="language-plaintext highlighter-rouge">8000</code> do site público, permitindo que ele seja acessado por outros sites conectados ao Skupper. O listener atua como um ponto de entrada na rede Skupper, recebendo conexões de outros sites e encaminhando-as para o serviço <code class="language-plaintext highlighter-rouge">instructlab</code> no site privado.</p></blockquote><blockquote><p><strong>Relacionamento Connector e Listener no Skupper:</strong></p><ul><li><strong>Listener</strong> (site público): <code class="language-plaintext highlighter-rouge">skupper listener create instructlab 8000</code> - cria um ponto de entrada na rede Skupper para receber conexões</ul><p>O <strong>connector</strong> “empurra” o serviço local para a rede Skupper, enquanto o <strong>listener</strong> “puxa” esse serviço para o site remoto. Juntos, eles criam um túnel seguro que permite que aplicações no site público acessem serviços no site privado como se fossem locais.</p></blockquote><h2 id="iniciando-o-serviço-do-modelo-no-site-privado"><span class="me-2">Iniciando o Serviço do Modelo no Site Privado</span><a href="#iniciando-o-serviço-do-modelo-no-site-privado" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Agora é hora de iniciar o serviço no terminal onde o site privado está sendo executado. Este é o passo final para ativar o modelo de IA e torná-lo disponível para receber requisições através da rede Skupper.</p><h3 id="configurando-o-servidor-para-acesso-externo"><span class="me-2">Configurando o Servidor para Acesso Externo</span><a href="#configurando-o-servidor-para-acesso-externo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Antes de iniciar o servidor, você precisa modificar o arquivo de configuração do InstructLab para permitir acesso externo. Por padrão, o InstructLab serve apenas na interface local (127.0.0.1), mas para funcionar com o Skupper, precisamos configurá-lo para aceitar conexões de qualquer interface.</p><p>Edite o arquivo de configuração localizado em <code class="language-plaintext highlighter-rouge">~/.config/instructlab/config.yaml</code> e modifique a seção <code class="language-plaintext highlighter-rouge">server</code>:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># Server configuration including host and port.</span>
<span class="nn">...</span>
  <span class="na">host</span><span class="pi">:</span> <span class="s">0.0.0.0</span>
  <span class="c1"># Port to serve on.</span>
  <span class="c1"># Default: 8000</span>
  <span class="na">port</span><span class="pi">:</span> <span class="m">8000</span>
</pre></table></code></div></div><blockquote><p>NOTA</p><p><strong><code class="language-plaintext highlighter-rouge">host: 0.0.0.0</code></strong>: Esta configuração permite que o servidor aceite conexões de todas as interfaces de rede, não apenas da interface local (localhost). Isso é essencial para que o Skupper consiga acessar o serviço.</p><p><strong><code class="language-plaintext highlighter-rouge">port: 8000</code></strong>: Mantém a porta padrão 8000, que corresponde à configuração do connector Skupper criado anteriormente.</p><p><strong><code class="language-plaintext highlighter-rouge">backend_type: llama-cpp</code></strong>: Especifica que será usado o backend llama-cpp para servir o modelo.</p></blockquote><p>Com essa configuração, o servidor estará pronto para receber conexões através da rede Skupper.</p><p>No terminal onde você configurou o Skupper privado (podman), certifique-se de que o ambiente virtual do InstructLab esteja ativado e execute o seguinte comando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cd </span>instructlab
<span class="nb">source </span>venv/bin/activate
ilab model serve <span class="nt">--model-path</span> ~/.cache/instructlab/models/DeepSeek-R1-Distill-Qwen-1.5B.gguf
</pre></table></code></div></div><blockquote><p>NOTA</p><p><strong><code class="language-plaintext highlighter-rouge">ilab model serve</code></strong>: Este comando inicia o servidor que será responsável por receber a entrada do usuário, enviá-la para o modelo DeepSeek e enviar a resposta de volta ao usuário.</p><p><strong><code class="language-plaintext highlighter-rouge">--model-path</code></strong>: Especifica o caminho para o modelo GGUF que será carregado pelo servidor.</p><p>O modelo ficará disponível na porta 8000 (configurada anteriormente no arquivo <code class="language-plaintext highlighter-rouge">config.yaml</code>) e será acessível através da rede Skupper que conecta os dois sites.</p></blockquote><p>Após executar este comando, você verá uma saída similar a esta indicando que o servidor está funcionando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>INFO 2025-01-15 10:30:45,123 Starting server on http://0.0.0.0:8000
INFO 2025-01-15 10:30:45,124 Model loaded successfully
INFO 2025-01-15 10:30:45,125 Server ready to accept connections
</pre></table></code></div></div><p>Agora o modelo DeepSeek está rodando no ambiente privado e disponível através da conexão segura Skupper para aplicações no site público.</p><h3 id="testando-a-conectividade-através-do-skupper-do-site-público"><span class="me-2">Testando a Conectividade através do Skupper do Site Público</span><a href="#testando-a-conectividade-através-do-skupper-do-site-público" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Agora que temos o modelo de IA rodando no site privado e a conexão Skupper estabelecida, vamos testar se a comunicação está funcionando corretamente a partir do site público (OpenShift).</p><p>Para testar a conectividade de dentro do cluster Kubernetes, vamos criar um pod temporário que pode fazer requisições HTTP para o serviço do InstructLab:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>kubectl run curl <span class="nt">--image</span><span class="o">=</span>quay.io/skupper/lanyard <span class="nt">-n</span> ilab-chat <span class="nt">--restart</span><span class="o">=</span>Never <span class="nt">--rm</span> <span class="nt">-i</span> <span class="nt">--tty</span> <span class="nt">--</span>  curl instructlab:8000
Warning: would violate PodSecurity <span class="s2">"restricted:latest"</span>: allowPrivilegeEscalation <span class="o">!=</span> <span class="nb">false</span> <span class="o">(</span>container <span class="s2">"curl"</span> must <span class="nb">set </span>securityContext.allowPrivilegeEscalation<span class="o">=</span><span class="nb">false</span><span class="o">)</span>, unrestricted capabilities <span class="o">(</span>container <span class="s2">"curl"</span> must <span class="nb">set </span>securityContext.capabilities.drop<span class="o">=[</span><span class="s2">"ALL"</span><span class="o">])</span>, runAsNonRoot <span class="o">!=</span> <span class="nb">true</span> <span class="o">(</span>pod or container <span class="s2">"curl"</span> must <span class="nb">set </span>securityContext.runAsNonRoot<span class="o">=</span><span class="nb">true</span><span class="o">)</span>, seccompProfile <span class="o">(</span>pod or container <span class="s2">"curl"</span> must <span class="nb">set </span>securityContext.seccompProfile.type to <span class="s2">"RuntimeDefault"</span> or <span class="s2">"Localhost"</span><span class="o">)</span>
<span class="o">{</span><span class="s2">"message"</span>:<span class="s2">"Hello from InstructLab! Visit us at https://instructlab.ai"</span><span class="o">}</span>pod <span class="s2">"curl"</span> deleted

</pre></table></code></div></div><blockquote><p>NOTA</p><p><strong><code class="language-plaintext highlighter-rouge">kubectl run curl --image=quay.io/skupper/lanyard -n ilab-chat --restart=Never --rm -i --tty --</code></strong>: Este comando cria um pod temporário usando a imagem <code class="language-plaintext highlighter-rouge">quay.io/skupper/lanyard</code>, que é uma imagem leve para executar comandos de rede. O pod é criado no namespace <code class="language-plaintext highlighter-rouge">ilab-chat</code> e será removido automaticamente após a execução.</p><p><strong><code class="language-plaintext highlighter-rouge">--restart=Never</code></strong>: Garante que o pod não será reiniciado após a execução, tornando-o um pod de uso único.</p><p><strong><code class="language-plaintext highlighter-rouge">curl -v http://instructlab:8000/</code></strong>: Este comando dentro do pod executa uma requisição HTTP para o serviço do InstructLab, que está rodando na porta 8000. O <code class="language-plaintext highlighter-rouge">-v</code> ativa o modo verbose, mostrando detalhes da requisição e resposta.</p></blockquote><h2 id="conclusão"><span class="me-2">Conclusão</span><a href="#conclusão" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Neste segundo ato da série, estabelecemos com sucesso a base fundamental para uma arquitetura segura de IA usando Skupper. Implementamos:</p><h3 id="o-que-foi-realizado"><span class="me-2">O que foi Realizado</span><a href="#o-que-foi-realizado" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Configuração do Ambiente InstructLab</strong>: Preparamos o ambiente completo para servir o modelo DeepSeek, incluindo a conversão para formato GGUF<li><strong>Infraestrutura Skupper Híbrida</strong>: Estabelecemos uma rede segura conectando um site público (Kubernetes) com um ambiente privado (Podman)<li><strong>Conexão Segura com Links</strong>: Utilizamos os novos comandos Skupper v2 (<code class="language-plaintext highlighter-rouge">skupper link generate</code> e <code class="language-plaintext highlighter-rouge">skupper system setup</code>) para criar uma conexão criptografada<li><strong>Arquitetura Connector/Listener</strong>: Implementamos o padrão onde o connector “empurra” o serviço privado para a rede Skupper e o listener “puxa” esse serviço para o site público<li><strong>Teste de Conectividade</strong>: Validamos que o modelo de IA no ambiente privado está acessível através da rede Skupper</ul><h3 id="benefícios-da-arquitetura"><span class="me-2">Benefícios da Arquitetura</span><a href="#benefícios-da-arquitetura" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Segurança por Design</strong>: O modelo de IA permanece em ambiente controlado e privado<li><strong>Zero Trust Network</strong>: Skupper cria túneis seguros sem exposição direta à internet<li><strong>Escalabilidade</strong>: Preparação para implantação de interfaces web no cluster público<li><strong>Observabilidade</strong>: Base estabelecida para monitoramento de tráfego entre sites</ul><h3 id="próximos-passos"><span class="me-2">Próximos Passos</span><a href="#próximos-passos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>No <strong>terceiro e último ato</strong>, vamos:</p><ul><li>Implantar a interface web do chatbot no Kubernetes<li>Configurar NGINX Ingress e LoadBalancer para acesso externo<li>Integrar a solução completa com o InstructLab<li>Finalizar a solução end-to-end</ul><p>Esta arquitetura fornece a base sólida para organizações que precisam manter seus modelos de IA seguros enquanto oferecem interfaces acessíveis aos usuários finais.</p><h2 id="referências"><span class="me-2">Referências</span><a href="#referências" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://github.com/instructlab">Comandos extraídos do projeto InstructLab</a><li><a href="https://developers.redhat.com/blog/2024/06/12/getting-started-instructlab-generative-ai-model-tuning#model_alignment_and_training_with_instructlab">Primeiros passos com o InstructLab: Ajuste de modelo de IA generativo</a><li><a href="https://github.com/instructlab/instructlab/blob/main/README.md#-installing-ilab">Guia de instalação do InstructLab</a><li><a href="https://github.com/rafaelvzago/ilab-client">Chatbot ILAB Frontend</a><li><a href="https://huggingface.co/docs/hub/en/security-tokens">Hugging Face Token</a><li><a href="https://github.com/ggerganov/llama.cpp">llama.cpp</a><li><a href="https://skupper.io/docs/">Skupper Documentation</a><li><a href="https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B">DeepSeek Model</a><li><a href="https://docs.podman.io/">Podman Documentation</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/ai/">AI</a>, <a href="/categories/kubernetes/">Kubernetes</a>, <a href="/categories/instructlab/">instructlab</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ai/" class="post-tag no-text-decoration" >ai</a> <a href="/tags/deepseek/" class="post-tag no-text-decoration" >deepseek</a> <a href="/tags/skupper/" class="post-tag no-text-decoration" >skupper</a> <a href="/tags/instructlab/" class="post-tag no-text-decoration" >instructlab</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/podman/" class="post-tag no-text-decoration" >podman</a> <a href="/tags/llama-cpp/" class="post-tag no-text-decoration" >llama-cpp</a> <a href="/tags/gguf/" class="post-tag no-text-decoration" >gguf</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> Esta postagem está licenciada sob <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> pelo autor.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Compartilhar</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Controlando%20e%20protegendo%20modelos%20de%20IA%20com%20seguran%C3%A7a%20usando%20Deepseek,%20Skupper%20e%20InstructLab%20-%20Segundo%20Ato%20-%20Rafael%20Zago&url=https%3A%2F%2Frafaelvzago.github.io%2Fposts%2Fcontrolando-progetendo-ia-deepseek-skupper-istio-segundo-ato%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Controlando%20e%20protegendo%20modelos%20de%20IA%20com%20seguran%C3%A7a%20usando%20Deepseek,%20Skupper%20e%20InstructLab%20-%20Segundo%20Ato%20-%20Rafael%20Zago&u=https%3A%2F%2Frafaelvzago.github.io%2Fposts%2Fcontrolando-progetendo-ia-deepseek-skupper-istio-segundo-ato%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Frafaelvzago.github.io%2Fposts%2Fcontrolando-progetendo-ia-deepseek-skupper-istio-segundo-ato%2F&text=Controlando%20e%20protegendo%20modelos%20de%20IA%20com%20seguran%C3%A7a%20usando%20Deepseek,%20Skupper%20e%20InstructLab%20-%20Segundo%20Ato%20-%20Rafael%20Zago" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copie o link" data-title-succeed="Link copiado com sucesso!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Atualizados recentemente</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/o-que-acontece-quando-voce-conversa-com-uma-ia/">O Que Acontece Quando Você Conversa com uma IA</a><li class="text-truncate lh-lg"> <a href="/posts/openshift-service-mesh-3/">OpenShift Service Mesh 3.0</a><li class="text-truncate lh-lg"> <a href="/posts/dominando-pipelines-de-alta-performance/">Dominando Pipelines de Alta Performance: Do ClickOps ao GitOps com Jenkins e CasC</a><li class="text-truncate lh-lg"> <a href="/posts/controlando-progetendo-ia-deepseek-skupper-istio-terceiro-ultimo-ato/">Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Terceiro e Último Ato</a><li class="text-truncate lh-lg"> <a href="/posts/controlando-progetendo-ia-deepseek-skupper-istio-segundo-ato/">Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Segundo Ato</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/skupper/">skupper</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">ai</a> <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/redhat/">redhat</a> <a class="post-tag btn btn-outline-primary" href="/tags/instructlab/">instructlab</a> <a class="post-tag btn btn-outline-primary" href="/tags/openshift/">openshift</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/llm/">llm</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Conteúdo</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Leia também</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/controlando-progetendo-ia-deepseek-skupper-istio-terceiro-ultimo-ato/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1746414000" data-df="DD/MM/YYYY" > 05/05/2025 </time><h4 class="pt-0 my-2">Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Terceiro e Último Ato</h4><div class="text-muted"><p>Neste artigo, vamos implementar e conectar o modelo de IA DeepSeek com o InstructLab usando Skupper para conectar de forma segura um modelo de IA privado com uma interface pública.</p></div></div></a></article><article class="col"> <a href="/posts/controlando-progetendo-ia-deepseek-skupper-istio-primeiro-ato/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1746154800" data-df="DD/MM/YYYY" > 02/05/2025 </time><h4 class="pt-0 my-2">Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Primeiro Ato</h4><div class="text-muted"><p>Descubra como implantar e operar modelos de IA com segurança em ambientes híbridos, usando Skupper e InstructLab para proteger dados sensíveis.</p></div></div></a></article><article class="col"> <a href="/posts/running-local-ai-with-instruct-lab/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1722481200" data-df="DD/MM/YYYY" > 01/08/2024 </time><h4 class="pt-0 my-2">Running local AI with Instruct Lab and Skupper</h4><div class="text-muted"><p>Welcome to the Ollama Pilot. Problem to solve The main goal of this project is to create a secure connection between two sites, enabling the communication between the engineer machine and an In...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/controlando-progetendo-ia-deepseek-skupper-istio-primeiro-ato/" class="btn btn-outline-primary" aria-label="Anterior" ><p>Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Primeiro Ato</p></a> <a href="/posts/controlando-progetendo-ia-deepseek-skupper-istio-terceiro-ultimo-ato/" class="btn btn-outline-primary" aria-label="Próximo" ><p>Controlando e protegendo modelos de IA com segurança usando Deepseek, Skupper e InstructLab - Terceiro e Último Ato</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/rafaelvzago">Rafael Zago</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Exceto onde indicado de outra forma, as postagens do blog neste site são licenciadas sob a Creative Commons Attribution 4.0 International (CC BY 4.0) License pelo autor." >Alguns direitos reservados.</span></p><p>Feito com <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando o tema <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/skupper/">skupper</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">ai</a> <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/networking/">networking</a> <a class="post-tag btn btn-outline-primary" href="/tags/redhat/">redhat</a> <a class="post-tag btn btn-outline-primary" href="/tags/instructlab/">instructlab</a> <a class="post-tag btn btn-outline-primary" href="/tags/openshift/">openshift</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/llm/">llm</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">Uma nova versão do conteúdo está disponível.</p><button type="button" class="btn btn-primary" aria-label="Update"> atualização </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! Nenhum resultado encontrado.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
